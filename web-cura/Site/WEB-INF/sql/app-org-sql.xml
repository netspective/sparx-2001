<?xml version="1.0"?>

<xaf>
	<sql-statements package="org">

		<statement name="name-only">
			select org_name from org where org_id = ?
			<params>
				<param value="request:org_id"/>
			</params>
		</statement>

        <statement name="name-id-list">
            select
                org_name,
                org_id
            from
                org, org_ownership
            where
                org.ownership = org_ownership.id(+) and
                org.org_name in (${param-list:0})
			<params>
				<param values="request-attr:orgs"/>
			</params>
        </statement>
		<statement name="registration">
			select
				org_code as "Code",
                org_name as "Name",
				org_abbrev as "Abbrev",
				org_ownership.caption as "Ownership",
				ticker_symbol as "Ticker",
				sic_code as "SIC",
				employees as "Employees",
				time_zone as "Time Zone"
			from org, org_ownership
			where org_id = ?
			and org.ownership = org_ownership.id (+)
			<params>
				<param value="request:org_id"/>
			</params>
			<report heading="Overview">
				<banner>
                    <item caption="Edit" url="config-expr:index.jsp?cmd=dialog,org.registration,edit&amp;org_id=${request:org_id}"/>
                    <item caption="Delete" url="config-expr:index.jsp?cmd=dialog,org.registration,delete&amp;org_id=${request:org_id}"/>
                </banner>
			</report>
		</statement>

		<statement name="classification">
			select 'Industry', ind_enum.caption
			from org, org_industry ind, org_industry_enum ind_enum
			where org.org_id = ?
			and org.org_id = ind.org_id
			and ind.org_industry = ind_enum.id
			union
			select 'Type', typ_enum.caption
			from org, org_type typ, org_type_enum typ_enum
			where org.org_id = ?
			and org.org_id = typ.org_id
			and typ.org_type = typ_enum.id
			<params>
				<param value="request:org_id"/>
				<param value="request:org_id"/>
			</params>
			<report heading="Classification"/>
		</statement>

        <statement name="contact-list">
			select
                person.person_id,
                person.complete_sortable_name,
                person.complete_name,
                org.org_name
			from
                personorg_relationship por, person, org
			where
                por.rel_org_id = ? and
                org.org_id = por.rel_org_id and
                por.parent_id = person.person_id and
                por.record_status_id = 1 and
                por.rel_type = 0
            order by
                person.complete_sortable_name
            <params>
                <param value="request:org_id"/>
            </params>
            <report heading="Organization Members">
                <banner>
                    <item caption="Import" url="config-expr:member.jsp?cmd=edit&amp;org_id=${request:org_id}&amp;org_name=${request:org_name}"/>
                    <item caption="Edit" url="config-expr:member.jsp?org_id=${request:org_id}&amp;org_name=${request:org_name}"/>
                </banner>
                <column heading="ID" align="left"/>
                <column heading="Name" url="create-app-url:/contact/home.jsp?person_id=${0}&amp;person_name=%{2}"/>
                <column display="no"/>
                <column heading="Organization"/>
            </report>

        </statement>
        <statement name="selected-org-person-list">
			select
                person.complete_sortable_name,
                person.person_id
			from
                personorg_relationship por, person
			where
                por.rel_org_id = ? and
                por.parent_id = person.person_id and
                por.record_status_id = 1 and
                por.rel_type = 0
            order by
                person.complete_sortable_name
            <params>
                <param value="session:organization"/>
            </params>
        </statement>

	</sql-statements>

</xaf>